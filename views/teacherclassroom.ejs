<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Portal</title>
    <%- include('partials/header')%>
        <!-- <%- include('partials/tablecss')%> -->
</head>

<body>

    <!-- NavBar -->
    <% if (isLogin==="teacher" ) { %>
        <%- include('partials/loginNavbar1') %>
            <% } else if (isLogin==="student" ) { %>
                <%- include('partials/loginNavbar2') %>
                    <% } else { %>
                        <%- include('partials/Navbar') %>
                            <% } %>




                                <!-- new content  -->

                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                                    <div
                                        class="col-span-1 md:col-span-1 top-0 left-0 w-full md:w-64 bg-white h-full md:border-r">
                                        <div class="overflow-y-auto overflow-x-hidden flex-grow">
                                            <ul class="flex flex-col py-4 space-y-1">
                                                <li>
                                                    <a href="#"
                                                        class="menu-item relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6"
                                                        onclick="changeTab(1)">
                                                        <span
                                                            class="inline-flex justify-center items-center ml-4 text-gray-800">
                                                            <svg class="w-5 h-5" fill="none" stroke="currentColor"
                                                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                                    stroke-width="2"
                                                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z">
                                                                </path>
                                                            </svg>
                                                        </span>
                                                        <span class="ml-2 text-sm tracking-wide truncate">Profile</span>
                                                    </a>
                                                </li>
                                                <li onclick="changeTab(2)">
                                                    <a href="#"
                                                        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6">
                                                        <span class="inline-flex justify-center items-center ml-4">
                                                            <svg class="w-5 h-5 text-gray-800 " aria-hidden="true"
                                                                xmlns="http://www.w3.org/2000/svg" fill="none"
                                                                viewBox="0 0 16 20">
                                                                <path stroke="currentColor" stroke-linecap="round"
                                                                    stroke-linejoin="round" stroke-width="2"
                                                                    d="M1 17V2a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H3a2 2 0 0 0-2 2Zm0 0a2 2 0 0 0 2 2h12M5 15V1m8 18v-4" />
                                                            </svg>
                                                        </span>
                                                        <span class="ml-2 text-sm tracking-wide truncate">Take
                                                            Attendance</span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#"
                                                        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6"
                                                        onclick="changeTab(3)">
                                                        <span class="ml-4">
                                                            <svg class="w-5 h-5 text-gray-600" aria-hidden="true"
                                                                xmlns="http://www.w3.org/2000/svg" fill="none"
                                                                viewBox="0 0 18 20">
                                                                <path stroke="currentColor" stroke-linecap="round"
                                                                    stroke-linejoin="round" stroke-width="2"
                                                                    d="M4 4H1m3 4H1m3 4H1m3 4H1m6.071.286a3.429 3.429 0 1 1 6.858 0M4 1h12a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1Zm9 6.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z" />
                                                            </svg>
                                                        </span>

                                                        <span class="ml-2 text-sm tracking-wide truncate">Defaulter
                                                            Students </span>
                                                        <span
                                                            class="px-2 py-0.5 ml-auto text-xs font-medium tracking-wide text-red-500 bg-red-50 rounded-full">-75%</span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#"
                                                        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6"
                                                        onclick="changeTab(4)">
                                                        <span class="inline-flex justify-center items-center ml-4">
                                                            <svg class="w-5 h-5 text-gray-800 " aria-hidden="true"
                                                                xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                                viewBox="0 0 17 14">
                                                                <path
                                                                    d="M16 2H1a1 1 0 0 1 0-2h15a1 1 0 1 1 0 2Zm0 6H1a1 1 0 0 1 0-2h15a1 1 0 1 1 0 2Zm0 6H1a1 1 0 0 1 0-2h15a1 1 0 0 1 0 2Z" />
                                                            </svg>
                                                        </span>
                                                        <span class="ml-2 text-sm tracking-wide truncate">List of
                                                            Students</span>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="/downloadAttendance"
                                                        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6">
                                                        <span class="inline-flex justify-center items-center ml-4">
                                                            <svg class="w-5 h-5 text-gray-800 " aria-hidden="true"
                                                                xmlns="http://www.w3.org/2000/svg" fill="none"
                                                                viewBox="0 0 16 18">
                                                                <path stroke="currentColor" stroke-linecap="round"
                                                                    stroke-linejoin="round" stroke-width="2"
                                                                    d="M8 1v11m0 0 4-4m-4 4L4 8m11 4v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3" />
                                                            </svg>
                                                        </span>
                                                        <span class="ml-2 text-sm tracking-wide truncate">Download
                                                            Attendance</span>
                                                    </a>
                                                </li>

                                                <li>
                                                    <a href="/logout"
                                                        class="relative flex flex-row items-center h-11 focus:outline-none hover:bg-gray-50 text-gray-600 hover:text-gray-800 border-l-4 border-transparent hover:border-indigo-500 pr-6">
                                                        <span class="inline-flex justify-center items-center ml-4">
                                                            <svg class="w-5 h-5" fill="none" stroke="currentColor"
                                                                viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                                    stroke-width="2"
                                                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                                                </path>
                                                            </svg>
                                                        </span>
                                                        <span class="ml-2 text-sm tracking-wide truncate">Logout</span>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>

                                    <!-- Main Content -->
                                    <!-- Profile -->
                                    <div class="col-span-1 md:col-span-4">
                                        <div class="mx-4 md:mx-8 mt-10 h-profile" id="profile">
                                            <div>
                                                <h3 class="text-lg font-semibold leading-7 text-gray-900 md:text-base">
                                                    Information</h3>
                                                <p class="mt-1 text-sm leading-6 text-gray-500">Personal details</p>
                                                <div class="mt-4 border-t border-gray-200">
                                                    <dl class="divide-y divide-gray-200">
                                                        <div class="py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                                            <dt class="text-sm font-medium leading-5 text-gray-500">
                                                                Full name</dt>
                                                            <dd
                                                                class="mt-1 text-sm leading-5 text-gray-900 sm:col-span-2">
                                                                <%= teacherData.fullName %>
                                                            </dd>
                                                        </div>
                                                        <div class="py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                                            <dt class="text-sm font-medium leading-5 text-gray-500">
                                                                Email address</dt>
                                                            <dd
                                                                class="mt-1 text-sm leading-5 text-gray-900 sm:col-span-2">
                                                                <%= teacherData.email %>
                                                            </dd>
                                                        </div>
                                                        <div class="py-3 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                                                            <dt class="text-sm font-medium leading-5 text-gray-500">
                                                                Class</dt>
                                                            <dd
                                                                class="mt-1 text-sm leading-5 text-gray-900 sm:col-span-2">
                                                                <%= teacherData._class %>
                                                            </dd>
                                                        </div>
                                                    </dl>
                                                </div>

                                            </div>
                                        </div>

                                        <!-- Take Attendance -->

                                        <div class="mx-4 hidden mt-10" id="attend">
                                            <form action="/submit-attendance" method="POST">
                                                <table
                                                    class="mt-6 w-full text-sm text-left rtl:text-right text-gray-500 border border-gray-300">
                                                    <thead
                                                        class="text-xs text-gray-700 uppercase bg-gray-50 text-center">
                                                        <tr class="">
                                                            <th scope="col" class="px-2 py-3">
                                                                Name
                                                            </th>
                                                            <th scope="col" class="px-2 py-3 ">
                                                                Roll No
                                                            </th>
                                                            <th scope="col" class="px-2 py-3 ">
                                                                Attendance
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% studentData.forEach(function(student) { %>
                                                            <% if(student.active && student.year==teacherData._class) {
                                                                %>
                                                                <tr class="bg-white border-b text-center">
                                                                    <th scope="row"
                                                                        class="px-2 py-4 font-medium text-gray-900 whitespace-nowrap ">
                                                                        <%= student.fullName %>
                                                                    </th>
                                                                    <td class="px-2 py-4 ">
                                                                        <%= student.rollNo %>
                                                                    </td>
                                                                    <td class="px-2 py-4 ">
                                                                        <input type="checkbox" name="attendance"
                                                                            value="<%= student.rollNo %>">
                                                                    </td>
                                                                </tr>
                                                                <% } %>
                                                                    <% }); %>
                                                    </tbody>
                                                </table>
                                                <button type="submit"
                                                    class="rounded-md bg-indigo-600 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 mt-4">Submit
                                                    Attendance</button>
                                            </form>
                                        </div>
                                        <div class="hidden mt-10 md:mx-3" id="defaulter">

                                            <div class="relative overflow-x-auto ">
                                                <table
                                                    class="w-full text-sm text-left rtl:text-right text-gray-500 border border-gray-300">
                                                    <thead
                                                        class="text-xs text-gray-700 uppercase bg-gray-50 text-center">
                                                        <tr>
                                                            <th scope="col" class="px-2 py-3">Name</th>
                                                            <th scope="col" class="px-2 py-3">Roll No</th>
                                                            <th scope="col" class="px-2 py-3">Attendance</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% studentData.forEach(function(student) { %>
                                                            <% if (student.active && student.year===teacherData._class)
                                                                { %>
                                                                <% var totalDays=teacherData.lectures.length %>
                                                                    <% var presentDays=0; %>
                                                                        <% student.attendance.forEach(function(attendanceRecord)
                                                                            { %>
                                                                            <% if (attendanceRecord.status==="present" )
                                                                                { %>
                                                                                <% presentDays++; %>
                                                                                    <% } %>
                                                                                        <% }); %>
                                                                                            <% var
                                                                                                attendancePercentage=(presentDays
                                                                                                / totalDays) * 100; %>
                                                                                                <% if
                                                                                                    ((attendancePercentage.toFixed(2))
                                                                                                    < 75) { %>
                                                                                                    <tr
                                                                                                        class="bg-white border-b text-center">
                                                                                                        <td
                                                                                                            class="px-2 py-4">
                                                                                                            <%= student.fullName
                                                                                                                %>
                                                                                                        </td>
                                                                                                        <td
                                                                                                            class="px-2 py-4">
                                                                                                            <%= student.rollNo
                                                                                                                %>
                                                                                                        </td>
                                                                                                        <td
                                                                                                            class="px-2 py-4">
                                                                                                            <%= attendancePercentage.toFixed(2)
                                                                                                                %>%
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    <% } %>
                                                                                                        <% } %>
                                                                                                            <% }); %>
                                                    </tbody>
                                                </table>


                                            </div>
                                        </div>


                                        <!--   List of Students  -->

                                        <div class="mt-10 md:mx-3">

                                            <div class="relative overflow-x-auto hidden" id="list">
                                                <table
                                                    class="w-full text-sm text-left rtl:text-right text-gray-500 border border-gray-300">
                                                    <thead
                                                        class="text-xs text-gray-700 uppercase bg-gray-50 text-center">
                                                        <tr class="">
                                                            <th scope="col" class="px-2 py-3">
                                                                Name
                                                            </th>
                                                            <th scope="col" class="px-2 py-3 ">
                                                                Roll No
                                                            </th>
                                                            <th scope="col" class="px-2 py-3 ">
                                                                Email
                                                            </th>
                                                            <th scope="col" class="px-2 py-3 ">
                                                                Year
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <% studentData.forEach(function(student) { %>
                                                            <% if(student.active && student.year==teacherData._class) {
                                                                %>
                                                                <tr class="bg-white border-b text-center">
                                                                    <%if(student.fullName){%>
                                                                        <td class="px-2 py-4 ">
                                                                            <%= student.fullName %>
                                                                        </td>
                                                                        <th scope="row"
                                                                            class="px-2 py-4 font-medium text-gray-900 whitespace-nowrap ">
                                                                            <%= student.rollNo %>
                                                                        </th>
                                                                        <td class="px-2 py-4 ">
                                                                            <%= student.email %>
                                                                        </td>
                                                                        <td class="px-2 py-4 ">
                                                                            <%= student.year %>
                                                                        </td>
                                                                        <%}%>
                                                                </tr>
                                                                <%}%>
                                                                    <% }); %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                </div>
                              
                                <footer class="bg-body-tertiary text-center text-lg-start mt-8 footer ">
                                    <!-- Copyright -->
                                    <div class="text-center p-3 bg-indigo-500">
                                        © 2024 Copyright:
                                        <a class="text-body" href="/">Attendance Portal</a>
                                    </div>
                                    <!-- Copyright -->
                                </footer>

</body>
<%- include('partials/scriptlink2')%>

</html>